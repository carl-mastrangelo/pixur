{{define "commentreply" }}
{{$pt := .Paths}}
{{$pr := $pt.Params}}
{{if .PicComment.CommentId }}
{{template "commenttext" .PicComment}}
{{.PicComment}}
{{end}}
<form action="{{$pt.CommentReply .PicComment.PicId .PicComment.CommentId}}" method="post">
  <textarea name="{{$pr.CommentText}}">{{.CommentText}}</textarea>
  <input type="hidden" name="{{$pr.Xsrf}}" value="{{.XsrfToken}}" />
  <input type="hidden" name="{{$pr.PicId}}" value="{{.PicComment.PicId}}" />
  <input type="hidden" name="{{$pr.CommentParentId}}" value="{{.PicComment.CommentId}}" />
  <input type="submit" value="Reply" />
</form>
{{end}}
{{define "commenttext"}}
{{$pt := .Paths}}
{{$pr := $pt.Params}}
<div id="{{($pt.ViewerComment .PicId .CommentId).Fragment}}">
	{{if .UserId}}{{if .UserId.Value}}[<a 
	  href="{{$pt.UserEvents .UserId.Value "" false}}"
	  >?</a>] {{end}}{{end}}{{.CommentId}}:
	{{.Text}}
</div>
{{end}}
